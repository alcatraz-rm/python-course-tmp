Разбил ваш код на файлы по задачам